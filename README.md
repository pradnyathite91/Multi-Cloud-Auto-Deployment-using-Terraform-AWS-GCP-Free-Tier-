# 🌐 Multi-Cloud Auto Deployment using Terraform (AWS + GCP Free Tier)

## 📌 Objective
Provision infrastructure on both **AWS** and **GCP** using **Terraform**, deploy **NGINX** web servers in each cloud, and validate automatic deployment with a **single Terraform command**. Simulate **failover routing** using **DNSMasq** on a local machine.

---

## 🧰 Tools & Technologies

- **Terraform**
- **AWS Free Tier (EC2, Security Groups)**
- **GCP Free Tier (Compute Engine, VPC)**
- **NGINX**
- **DNSMasq** (Local DNS to simulate routing)
- **Debin/Amazon Linux for local and remote instances**

  ---

  ## ✅ Next Steps After Infrastructure Creation
  1.Launch EC2 (Amazon Linux) via GUI
  - Go to AWS Console → EC2 → Launch Instances
  - Name it, choose Amazon Linux 2023 AMI
  - Select t2.micro (Free Tier)
  - Choose or create Key Pair
  - Allow SSH (22) and HTTP (80)
  - launch instance
  - Install Terraform
    ```bash
    sudo yum install -y yum-utils
    ```
    ```bash
    sudo yum-config-manager --add-repo https://rpm.releases.hashicorp.com/AmazonLinux/hashicorp.repo
    ```
    ```bash
    sudo yum -y install terraform
    ```
    ```bash
    mkdir project
    cd project
    ```
    ```bash
    vi aws.tf
    add here aws.tf file script
    ```
     Overview
  
 This Terraform script provisions a custom VPC, subnet, and security group in the AWS Mumbai region (ap-south-1). It deploys 3 EC2 instances (Dev, QA, XY) with NGINX on the Dev and QA instances, and simple HTML files as a welcome message.

    Steps:
    1. Configure AWS Provider:
    Sets the AWS region and credentials (access_key, secret_key).
    2. VPC and Subnet:
    Creates a custom VPC (10.10.0.0/16) and a subnet (10.10.1.0/24).
    3. Internet Gateway & Route Table:
    Configures an Internet Gateway and a Route Table with a default route to the internet.
    4. Security Group:
    Creates a security group allowing SSH (22), HTTP (80), custom HTTP (8080), and ICMP (ping).
    5. EC2 Instances:
    Dev & QA Instances:
    Installs NGINX and sets a custom hostname (Dev, QA).
    Creates a basic HTML page with a welcome message.
    XY Instance:
    Sets hostname (XY) and creates a simple HTML welcome page (no NGINX).
    6. Outputs:
    Displays the public IPs of the Dev, QA, and XY instances.
```bash
terraform init
```
```bash
terraform apply --auto-approve
```
- Login XY machine
 ```bash
  sudo -i
```
```bash
  yum install dnsmasq -y
```
- vi /etc/dnsmasq.conf
   ```bash
   address=/dev.pradnya.local/PRIVATE_IP
   address=/qa.pradnya.local/PRIVATE_IP
   listen-address=127.0.0.1
   ```
- vi /etc/resolv.conf
   ```bash
   options timeout:2 attempts:5
   ; generated by /usr/sbin/dhclient-script
   search ap-south-1.compute.internal
   nameserver 127.0.0.1
   ```
  ```bash
  sudo systemctl restart dnsmasq
  ```
  we can see logs in this command 
   ```bash
     ping dev.pradnya.local
  ```
   we can see logs in this command 
    ```bash
     ping qa.pradnya.local
  ```
- Login QA machine
- see the vesionof nginx
   ```bash
      nginx -v
     ```
    - go to the browser (http://PUBLIC_IP)
     
- Login Dev machine
- see the vesionof nginx
   ```bash
      nginx -v
     ```
   - go to the browser (http://PUBLIC_IP)
     
          GCP Project & JSON Key Setup (Short Guide)
      
          1.Create GCP Project:
          Go to GCP Console
          Click project dropdown → New Project
          Name it and click Create
          2.Enable APIs:
          Go to API Library
          Enable: Compute Engine API, IAM API
          3.Create Service Account:
          Go to IAM & Admin > Service Accounts
          Click Create Service Account
          Name it, click Continue
          Add roles: Editor, Compute Admin, Service Account User
          Click Done
          4.Create Key (.json):
          In the service account list, click 3 dots → Manage Keys
          Click Add Key > Create New Key
          Choose JSON → Download the file
          5.Use in Terraform:
 ```bash
This .json file create in your MobaXstrem
credentials = file("your-key.json")

 ```
  ```bash
    vi gcp.tf
    add here gcp.tf file script
   ```
    Overview
  
This Terraform configuration provisions infrastructure on Google Cloud Platform (GCP) including a custom VPC, subnet, firewall rules, and 3 VM instances (dev, qa, xy) with NGINX installed.
Key Components

    1.GCP Provider Configuration
    Authenticates using a JSON key file.
    Sets project, region (asia-south1), and zone (asia-south1-a).
    2.Networking
    Creates a custom VPC (my-vpc-1) and subnet (10.10.1.0/24).
    3.Firewall Rules
    Allows HTTP (80, 8080), SSH (22), and ICMP (ping) from all IPs.
    4.Startup Script
    Installs and enables NGINX on each VM at boot.
    5.VM Instances
    Launches 3 e2-micro instances with Debian 11.
    Applies the startup script to install NGINX.
    6.Outputs
    Displays public IP addresses of the created instances.

   ```bash
   terraform init
  ```
  ```bash
  terraform apply --auto-approve
  ```
 Login XY machine
   ```bash
   sudo -i
   ```
  ```bash
  apt install dnsmasq -y
  ```
 vi /etc/dnsmasq.conf
   ```bash
   address=/dev.pradnya.local/PRIVATE_IP
   address=/qa.pradnya.local/PRIVATE_IP
   listen-address=127.0.0.1
   ```
  vi /etc/resolv.conf
   ```bash
   options timeout:2 attempts:5
   ; generated by /usr/sbin/dhclient-script
   search ap-south-1.compute.internal
   nameserver 127.0.0.1
   ```
  ```bash
  sudo systemctl restart dnsmasq
  ```
  we can see logs in this command 
   ```bash
     ping dev.pradnya.local
  ```
   we can see logs in this command 
   ```bash
          ping qa.pradnya.local
   ```
  Login QA machine
  see the vesionof nginx
  ```bash
        nginx -v
  ```
  go to the browser (http://PUBLIC_IP)
     
 Login Dev machine
 see the vesionof nginx
   ```bash
       nginx -v
   ```
   go to the browser (http://PUBLIC_IP)
  
 



  
    
  
